{
    "pipeline": {
      "name": "embed-docs",
      "project": {
        "name": "pdf-rag-andrew"
      }
    },
    "transform": {
      "image": "vmtyler/pdk:embed-v0.0.10a",
      "cmd": [
        "/bin/bash",
        "-C"
      ],
      "stdin": [
        "python3 /pfs/code/embed.py --data-path /pfs/data --emb-model-path /data/snowflake-arctic-embed-l/ --path-to-db /pfs/out/"
      ],
      "env": {
        "PYTHON_UNBUFFERED": "1"
      }
    },
    "input": {
      "cross":
      [{"pfs": {
        "repo": "chunk-docs",
        "name": "data",
        "glob": "/"
      }},
      {"pfs": {
        "repo": "code",
        "glob": "/"
      }}]
    },
    "resourceLimits": {
      "gpu": {
        "type": "nvidia.com/gpu",
        "number": 1
      }
    },
    "autoscaling": false,
    "podPatch": "[{\"op\": \"add\",\"path\": \"/volumes/-\",\"value\": {\"name\": \"data-store\",\"hostpath\": {\"path\": \"/nvmefs1/tyler.britten\",\"type\": \"Directory\"}}}, {\"op\": \"add\",\"path\": \"/containers/0/volumeMounts/-\",\"value\": {\"mountPath\": \"/data\",\"name\": \"data-store\"}}]"
  }
